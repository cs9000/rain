<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wimauma Weather</title>
    <!-- Chosen Palette: Cool Tones (Blue, Green, Purple) -->
    <!-- Application Structure Plan: A single-view SPA with a primary display of three forecast cards for quick outlooks. A secondary, toggleable "details" view provides a deeper dive into hourly data. This structure prioritizes at-a-ance information first, with an intuitive action (button click) to reveal more complex data, preventing initial cognitive overload for the user. The user flow is simple: view summary -> click for details -> click to hide details. This was chosen for its clarity and common use in dashboard-style applications. -->
    <!-- Visualization & Content Choices: Report Info: Daily forecast summary -> Goal: Quick overview -> Viz/Presentation: Three distinct, color-coded summary cards -> Interaction: None, purely informational -> Justification: Cards provide a scannable, high-level summary. Report Info: Hourly forecast data -> Goal: Detailed planning -> Viz/Presentation: Tabular data -> Interaction: "See/Hide Details" button toggles visibility -> Justification: A table is the clearest way to present dense, structured hourly data. Library/Method: Vanilla JS for DOM manipulation and API fetching. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .weather-card {
            transition: all 0.3s ease-in-out;
            animation: fadeIn 0.8s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .details-table-day {
            animation: fadeIn 0.5s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 sm:p-8">

    <main class="w-full max-w-4xl p-6 space-y-6 bg-white rounded-3xl shadow-2xl">
        <header class="text-center">
            <h1 class="text-3xl font-extrabold text-gray-800">Wimauma Outlook</h1>
        </header>

        <section id="weather-cards" class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div id="loading-spinner" class="col-span-1 md:col-span-3 text-center p-8">
                <div class="inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]" role="status">
                    <span class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]">Loading...</span>
                </div>
                <p class="mt-4 text-gray-500">Loading weather data...</p>
            </div>
        </section>

        <div class="text-center mt-6">
            <button id="toggle-details-btn" class="py-3 px-8 bg-blue-500 text-white font-bold rounded-full shadow-lg hover:bg-blue-600 transition-colors transform hover:scale-105">
                See Details
            </button>
        </div>

        <section id="details-table-container" class="mt-8 transition-all duration-500 hidden">
        </section>

        <div id="message-box" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden flex items-center justify-center p-4">
            <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-sm text-center">
                <h3 class="text-xl font-bold mb-4" id="message-title"></h3>
                <p class="text-gray-600 mb-6" id="message-content"></p>
                <button onclick="hideMessage()" class="py-2 px-6 bg-blue-500 text-white font-semibold rounded-full hover:bg-blue-600 transition-colors">
                    Close
                </button>
            </div>
        </div>
    </main>

    <script>
        let correctForecastData = null;

        function showMessage(title, content) {
            document.getElementById('message-title').textContent = title;
            document.getElementById('message-content').textContent = content;
            document.getElementById('message-box').classList.remove('hidden');
        }

        function hideMessage() {
            document.getElementById('message-box').classList.add('hidden');
        }
        
        function calculateRainfall(hourlyData, startHour, endHour) {
            let totalRain = 0;
            for (let i = startHour; i <= endHour; i++) {
                if (hourlyData[i]) {
                    totalRain += hourlyData[i].precip_in;
                }
            }
            return totalRain > 0 ? ` (${totalRain.toFixed(1)} in)` : '';
        }

        function renderDetailsTables() {
            const container = document.getElementById('details-table-container');
            container.innerHTML = ''; 
            
            if (!correctForecastData) return;

            correctForecastData.forEach((day) => {
                const dayOfWeek = new Date(day.date + 'T00:00:00').toLocaleDateString('en-US', { weekday: 'long' });

                const daySectionHtml = `
                    <div class="mb-8 details-table-day">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">${dayOfWeek}</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left bg-white rounded-xl shadow-md">
                                <thead class="bg-gray-200">
                                    <tr>
                                        <th class="py-4 px-6 rounded-tl-xl text-sm font-semibold text-gray-600 uppercase tracking-wider">Time</th>
                                        <th class="py-4 px-6 text-sm font-semibold text-gray-600 uppercase tracking-wider">Condition</th>
                                        <th class="py-4 px-6 text-sm font-semibold text-gray-600 uppercase tracking-wider">Temp (°F)</th>
                                        <th class="py-4 px-6 text-sm font-semibold text-gray-600 uppercase tracking-wider">Rain (%)</th>
                                        <th class="py-4 px-6 rounded-tr-xl text-sm font-semibold text-gray-600 uppercase tracking-wider">Rain (in)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${day.hour.map(hour => `
                                        <tr class="border-t border-gray-200 hover:bg-gray-50 transition-colors">
                                            <td class="py-4 px-6 font-medium text-gray-900">${new Date(hour.time).toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })}</td>
                                            <td class="py-4 px-6 text-gray-700">${hour.condition.text}</td>
                                            <td class="py-4 px-6 text-gray-700">${Math.round(hour.temp_f)}</td>
                                            <td class="py-4 px-6 text-gray-700">${hour.chance_of_rain}</td>
                                            <td class="py-4 px-6 text-gray-700">${hour.precip_in}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
                container.innerHTML += daySectionHtml;
            });
        }

        function toggleDetailsTable() {
            const detailsContainer = document.getElementById('details-table-container');
            const toggleButton = document.getElementById('toggle-details-btn');

            if (detailsContainer.classList.contains('hidden')) {
                if (correctForecastData) {
                    renderDetailsTables();
                    detailsContainer.classList.remove('hidden');
                    toggleButton.textContent = 'Hide Details';
                }
            } else {
                detailsContainer.classList.add('hidden');
                toggleButton.textContent = 'See Details';
            }
        }
        
        async function fetchWeather(location, days) {
            const apiKey = '7b2406496cd94d9f8ad151853252208';
            const url = `https://api.weatherapi.com/v1/forecast.json?key=${apiKey}&q=${location}&days=${days}`;

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                document.getElementById('loading-spinner').classList.add('hidden');

                const weatherCardsContainer = document.getElementById('weather-cards');
                weatherCardsContainer.innerHTML = '';

                const colors = ['from-red-200 to-orange-300', 'from-teal-200 to-cyan-300', 'from-purple-200 to-indigo-300'];
                
                const today = new Date();
                const todayDateString = today.toISOString().split('T')[0];

                let startIndex = data.forecast.forecastday.findIndex(day => day.date === todayDateString);
                if(startIndex === -1) startIndex = 0; 
                
                correctForecastData = data.forecast.forecastday.slice(startIndex, startIndex + 3);
                
                if (correctForecastData.length < 3) {
                     showMessage('Data Issue', 'Could not retrieve a full three-day forecast. Displaying available data.');
                }
                
                correctForecastData.forEach((day, i) => {
                    const date = new Date(day.date + 'T00:00:00');
                    const dayOfWeek = date.toLocaleDateString('en-US', { weekday: 'long' });
                    
                    const morningData = day.hour[10];
                    const morningRain = calculateRainfall(day.hour, 6, 11);

                    const afternoonData = day.hour[15];
                    const afternoonRain = calculateRainfall(day.hour, 12, 17);

                    const eveningData = day.hour[20];
                    const eveningRain = calculateRainfall(day.hour, 18, 23);

                    const cardHtml = `
                        <div class="relative p-6 rounded-3xl text-gray-900 shadow-xl hover:shadow-2xl hover:scale-105 transition-transform flex flex-col space-y-4 bg-gradient-to-br ${colors[i]} weather-card">
                            <div class="flex flex-col items-start">
                                <h2 class="text-3xl font-bold">${dayOfWeek}</h2>
                                <span class="text-xl font-bold">${Math.round(day.day.mintemp_f)}° / ${Math.round(day.day.maxtemp_f)}°</span>
                            </div>
                            
                            <div class="mt-4 space-y-2">
                                <div class="grid grid-cols-[60px,32px,1fr] items-center gap-2">
                                    <span class="text-sm font-bold md:font-normal">Morning</span>
                                    <img src="https:${morningData.condition.icon}" alt="Morning weather" class="w-8 h-8">
                                    <span class="text-base font-medium md:text-sm md:font-normal">${morningData.condition.text} ${morningRain}</span>
                                </div>
                                <div class="grid grid-cols-[60px,32px,1fr] items-center gap-2">
                                    <span class="text-sm font-bold md:font-normal">Afternoon</span>
                                    <img src="https:${afternoonData.condition.icon}" alt="Afternoon weather" class="w-8 h-8">
                                    <span class="text-base font-medium md:text-sm md:font-normal">${afternoonData.condition.text} ${afternoonRain}</span>
                                </div>
                                <div class="grid grid-cols-[60px,32px,1fr] items-center gap-2">
                                    <span class="text-sm font-bold md:font-normal">Evening</span>
                                    <img src="https:${eveningData.condition.icon}" alt="Evening weather" class="w-8 h-8">
                                    <span class="text-base font-medium md:text-sm md:font-normal">${eveningData.condition.text} ${eveningRain}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    weatherCardsContainer.innerHTML += cardHtml;
                });
                
                document.getElementById('toggle-details-btn').addEventListener('click', toggleDetailsTable);

            } catch (error) {
                console.error("Could not fetch weather data:", error);
                document.getElementById('loading-spinner').classList.add('hidden');
                showMessage('Error', 'Failed to fetch weather data. Please check your connection or API key.');
            }
        }
        
        window.onload = () => {
            fetchWeather('33598', 7);
        };
    </script>
</body>
</html>
